if (self.CavalryLogger) { CavalryLogger.start_js(["imlWL"]); }

__d("TepigSubscriberCometQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"params",type:"TepigMetadataParams!",defaultValue:null}],b=[{kind:"LinkedField",alias:null,name:"tepig_post_metadata",storageKey:null,args:[{kind:"Variable",name:"params",variableName:"params"}],concreteType:"TepigTrackUnitMetadata",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"post_type_based_trackable",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"post_id_based_trackable",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"post_name_based_trackable",args:null,storageKey:null}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"TepigSubscriberCometQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:b},operation:{kind:"Operation",name:"TepigSubscriberCometQuery",argumentDefinitions:a,selections:b},params:{operationKind:"query",name:"TepigSubscriberCometQuery",id:"2328311430556732",text:null,metadata:{}}}}();e.exports=a}),null);
__d("TepigSubscriberQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"params",type:"TepigMetadataParams!",defaultValue:null}],b=[{kind:"LinkedField",alias:null,name:"tepig_post_metadata",storageKey:null,args:[{kind:"Variable",name:"params",variableName:"params"}],concreteType:"TepigTrackUnitMetadata",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"post_name",args:null,storageKey:null}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"TepigSubscriberQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:b},operation:{kind:"Operation",name:"TepigSubscriberQuery",argumentDefinitions:a,selections:b},params:{operationKind:"query",name:"TepigSubscriberQuery",id:"2204155006350272",text:null,metadata:{}}}}();e.exports=a}),null);
__d("TepigCometPostsWaitingList",[],(function(a,b,c,d,e,f){"use strict";var g={};a=function(a){if(g[a]!=null)return!1;g[a]=1;return!0};e.exports={addToGraphqlCallList:a}}),null);
__d("TepigPostNames",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={},h={};a=function(a,b){g[a]==null?g[a]=b:g[a]!==b&&(g[a]=b)};b=function(a,b,c,d){h[a]={error:null,id_type:d,post_or_ad_id:b,post_title:c}};c=function(a){return h[a]?h[a]:null};d=function(a){return g[a]?g[a]:null};e.exports={addPostName:a,addTepigCometTokenData:b,getPostName:d,getTepigCometTokenData:c}}),null);
__d("TepigProcessCometPosts",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={};a=function(a,b,c){__p&&__p();var d;d=(d=i(b))!=null?d:"";b=(b=j(b))!=null?b:null;if(!b)return!1;d=d+b;if(g[a.postOrAdId]==null){var e;g[a.postOrAdId]={data:(e={},e.enter=[],e.exit=[],e),isLogPresent:!1,warning:0};setTimeout(function(){h(c,a.postOrAdId)},3e3)}e=g[a.postOrAdId].data;if(b==="log"){g[a.postOrAdId].isLogPresent=!0;return!0}else if(!e[b].includes(d)){e[b].push(d);return!0}else if(e.enter.length===2&&e.exit.length===2){e.enter=[];e.exit=[];e[b].push(d);g[a.postOrAdId].warning=0;return!0}e.enter=[];e.exit=[];g[a.postOrAdId].warning=0;return!1};var h=function(a,b){g[b].isLogPresent||a()};b=function(a){var b=!0;Object.keys(g).map(function(c){if(a===c)return;c=g[c];c.data.enter.length!==2||c.data.exit.length%2!==0?(c.warning+=1,c.warning>30&&(b=!1)):c.warning=0});return b};var i=function(a){a=a.TepigExternalSignalPayload!=null?a.TepigExternalSignalPayload.impressionFramework:a.TepigExternalValidationSignalPayload!=null?a.TepigExternalValidationSignalPayload.impressionFramework:null;return a},j=function(a){a=a.TepigExternalSignalPayload!=null?a.TepigExternalSignalPayload.signalType:a.TepigExternalValidationSignalPayload!=null?a.TepigExternalValidationSignalPayload.signalType:null;return a};e.exports={addAndCheckTepig:a,verifyAllSignals:b}}),null);
__d("TepigSubscriber",["requireCond","BanzaiODS","DataAttributeUtils","RelayFBEnvironment","TepigCometPostsWaitingList","TepigPostNames","TepigProcessCometPosts","cr:1087053","gkx","promiseDone","relay-runtime","TepigSubscriberCometQuery.graphql","TepigSubscriberQuery.graphql"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h,i=b("TepigCometPostsWaitingList").addToGraphqlCallList,j=b("TepigPostNames").addPostName,k=b("TepigPostNames").getPostName,l=b("TepigProcessCometPosts").addAndCheckTepig,m=b("TepigProcessCometPosts").verifyAllSignals,n=b("relay-runtime").fetchQuery;b("relay-runtime").graphql;var o=function(a,b){};a=[];var p=o,q=o,r=a;c=function(a){p=a;return function(){p=o}};d=function(a){q=a;s();return function(){q=o}};var s=function(){__p&&__p();var a=null;r=r.filter(function(c){__p&&__p();if(p!==o&&c.source==="blue"){if(!p(c.TepigInternalPayload,c.TepigExternalPayload))return c}else if(q!==o&&c.source==="comet"){if(!q(c.TepigInternalPayload,c.TepigExternalPayload))return c}else if(q===o&&c.source==="comet"&&!c.ranInBackground&&!c.TepigInternalPayload.graphqlData){a=c.TepigInternalPayload.postOrAdId;l(c.TepigInternalPayload,c.TepigExternalPayload,t)||b("cr:1087053")&&b("cr:1087053").report("Signal mismatch");c.ranInBackground=!0;return c}else return c});a&&!m(a)&&t()},t=function(){b("cr:1087053")&&b("cr:1087053").report("Log Failure")};f=function(a){if(!(b("gkx")("985099")||b("gkx")("1087054"))||!x(a))return;var c=a.TepigExternalSignalPayload?a.TepigExternalSignalPayload.targetElem?a.TepigExternalSignalPayload.targetElem:null:a.TepigExternalValidationSignalPayload?a.TepigExternalValidationSignalPayload.targetElem?a.TepigExternalValidationSignalPayload.targetElem:null:null,d=a.TepigExternalSignalPayload?a.TepigExternalSignalPayload.source:a.TepigExternalValidationSignalPayload?a.TepigExternalValidationSignalPayload.source:null;d==="blue"?w(c,a):d==="comet"&&v(a)};var u=function(a,b,c,d){if(a.error!=null)return;var e=Date.now();d={graphqlData:d,idType:(d=a.id_type)!=null?d:"post_id",postName:a.post_title,postOrAdId:a.post_or_ad_id,time:e};r.push({TepigExternalPayload:b,TepigInternalPayload:d,ranInBackground:!1,source:c});s()},v=function(a){__p&&__p();if(a.TepigExternalSignalPayload==null||a.TepigExternalSignalPayload.trackable==null)return;var c=a.TepigExternalSignalPayload.trackable,d=i(c),e={error:null,id_type:"post_id",post_or_ad_id:c,post_title:"Retrieving"};u(e,a,"comet",!1);if(!d)return;e=g!==void 0?g:g=b("TepigSubscriberCometQuery.graphql");d={params:{trackable:c}};b("promiseDone")(n(b("RelayFBEnvironment"),e,d).then(function(b){if(b==null||b.tepig_post_metadata==null||b.tepig_post_metadata.post_type_based_trackable==null||b.tepig_post_metadata.post_id_based_trackable==null||b.tepig_post_metadata.post_name_based_trackable==null)return;b=b.tepig_post_metadata;var c={error:null,id_type:b.post_type_based_trackable,post_or_ad_id:b.post_id_based_trackable,post_title:b.post_name_based_trackable};j(b.id,b.post_name_based_trackable);u(c,a,"comet",!0)}))},w=function(a,c){__p&&__p();if(a==null)return;var d={error:null,id_type:null,post_or_ad_id:"",post_title:""};try{a=JSON.parse(b("DataAttributeUtils").getDataFt(a));if(a!=null){var e;e=a==null?void 0:(e=a.page_insights)==null?void 0:(e=e[a==null?void 0:a.page_id])==null?void 0:(e=e.targets)==null?void 0:(e=e[0])==null?void 0:e.post_id;var f=a==null?void 0:a.adid;a=a==null?void 0:a.top_level_post_id;var g=null,i=null;e==null&&(e=a);if(f!=null&&f!==0){a=k(f);a!=null?(d.post_title=a,d.post_or_ad_id=f,u(d,c,"blue",!0)):(g=f,i="ad_id")}else if(e!=null&&e!==0){a=k(e);a!=null?(d.post_title=a,d.post_or_ad_id=e,u(d,c,"blue",!0)):(g=e,i="post_id")}if(g!=null&&i!=null){f=h!==void 0?h:h=b("TepigSubscriberQuery.graphql");e={params:(a={},a[i]=g,a)};b("promiseDone")(n(b("RelayFBEnvironment"),f,e).then(function(a){if(a==null||a.tepig_post_metadata==null||a.tepig_post_metadata.post_name==null||g==null||i==null)d.error="GraphQL query failed";else{var b;j(g,a==null?void 0:(b=a.tepig_post_metadata)==null?void 0:b.post_name);d.post_or_ad_id=g;d.post_title=(a=a==null?void 0:(b=a.tepig_post_metadata)==null?void 0:b.post_name)!=null?a:"";d.id_type=i;u(d,c,"blue",!0)}}))}}}catch(a){b("BanzaiODS").bumpEntityKey(2977,"tepig_subscriber","subscriber failure. error fetching post_name using graphql."+a.message),d.error="Error caught (graphql attempt)"+String(a),u(d,c,"blue",!0)}},x=function(a){__p&&__p();var b=["current_blue","intersection_observer_blue","impression_api_comet_enter","scroll_comet"],c=["enter","exit","log","validate"];if(a.TepigExternalSignalPayload!=null){var d=a.TepigExternalSignalPayload.impressionFramework,e=a.TepigExternalSignalPayload.signalType;if(b.includes(d)&&c.includes(e))return!0;else return!1}if(a.TepigExternalValidationSignalPayload!=null){b=a.TepigExternalValidationSignalPayload;d=b.validationSession.getPrimaryImpressionChannel();c=b.validationSession.getSecondaryImpressionChannel();if(d==="current_blue"&&c==="intersection_observer_blue")return!0;else return!1}return!1};e.exports={addTepigListener:d,sendSignal:f,subscribeToSignals:c}}),null);
__d("sendTepigValidationSignal",["TepigSubscriber"],(function(a,b,c,d,e,f){"use strict";var g=b("TepigSubscriber").sendSignal;function a(a,b,c,d,e,f,h){e={failureReason:e,impressionFramework:a,signalType:c,source:h,targetElem:b,validationResult:d,validationSession:f};a={TepigExternalSignalPayload:null,TepigExternalValidationSignalPayload:e};g(a)}e.exports=a}),null);
__d("ViewableSession",["ViewableSessionValidationWebResultTypedLogger","getCentralImpressionScrollSpeed","getCentralImpressionTimeAfterRefresh","sendTepigValidationSignal"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=1,h=0,i="impression when there was no active session",j="missing impression when session ends",k=1e3;a=function(){__p&&__p();function a(a,b,c,d,e,f){this.$2=!1,this.$3=-1,this.$4=-1,this.$5=!1,this.$6=-1,this.$1=a,this.$7=b,this.$8=e,this.$9=c,this.$10=d,this.$11=f}var c=a.prototype;c.start=function(){this.$3=Date.now(),this.$2=!0};c.end=function(){this.$4=Date.now(),this.$2=!1};c.setImpressed=function(){this.$6=Date.now(),this.$5=!0};c.validate=function(){__p&&__p();var a,c=null;if(this.$5)if(this.$3!==-1)a=g;else if(Date.now()-this.$6>k)a=h,c=i;else return!1;else if(!this.$2&&Date.now()-this.$4>k)a=h,c=j;else return!1;b("sendTepigValidationSignal")(this.$9,this.$11,"validate",a,c,this,"blue");var d=b("getCentralImpressionScrollSpeed")(),e=b("getCentralImpressionTimeAfterRefresh")();new(b("ViewableSessionValidationWebResultTypedLogger"))().setVerificationTime(Date.now()).setFbFeedLocation(this.$7).setSessionKey(this.$1).setExtras(this.$8).setVerifyResult(a).setFailureReason(c).setPrimaryImpressionChannel(this.$9).setSecondaryImpressionChannel(this.$10).setSessionStartTime(this.$3).setSessionEndTime(this.$4).setScrollSpeed(d).setTimeFromLoad(e).log();return!0};c.getSessionKey=function(){return this.$1};c.getPrimaryImpressionChannel=function(){return this.$9};c.getSecondaryImpressionChannel=function(){return this.$10};c.getImpressed=function(){return this.$5};return a}();e.exports=a}),null);
__d("ViewableSessionManager",["BanzaiODS","DataAttributeUtils","ViewableSession"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={},h=(d={},d.intersection_observer_blue=["current_blue"],d.scroll_based_blue=["current_blue"],d.current_blue=["intersection_observer_blue","scroll_based_blue"],d);function a(a,c){__p&&__p();try{var d=l(a);d.map(function(d){var e=i(a,d,c),f=JSON.parse(b("DataAttributeUtils").getDataFt(c));if(!e||!f)return;e=j(e,(e=f.fbfeed_location)!=null?e:-1,d,a,JSON.stringify(f),c);e.start();e=i(d,a,c);e=j(e,(e=f.fbfeed_location)!=null?e:-1,a,d,JSON.stringify(f),c);e.setImpressed();k()})}catch(a){b("BanzaiODS").bumpEntityKey(2966,"impression_logging_debug","onItemEnterViewport"+a.message)}}function c(a,c){try{var d=l(a);d.map(function(b){b=i(a,b,c);if(!b)return;g[b]&&g[b].end();k()})}catch(a){b("BanzaiODS").bumpEntityKey(2966,"impression_logging_debug","onItemExitViewport"+a.message)}}function i(a,c,d){__p&&__p();d=JSON.parse(b("DataAttributeUtils").getDataFt(d));if(d){var e,f,g=d.page_id;e=(e=d.top_level_post_id)!=null?e:(e=d)!=null?(e=e.page_insights)!=null?(e=e[g])!=null?(e=e.targets)!=null?(e=e[0])!=null?e.post_id:e:e:e:e:e;var h=d.adid;f=(f=h)!=null?f:e;d=d.fbfeed_location;if(h||e&&g)return[f,d,a,c].join("_")}return""}function j(a,c,d,e,f,h){g[a]||(g[a]=new(b("ViewableSession"))(a,c,d,e,f,h));return g[a]}function k(){Object.keys(g).map(function(a){g[a].validate()&&delete g[g[a].getSessionKey()]})}function l(a){return h[a]}e.exports={onItemEnterViewport:a,onItemExitViewport:c}}),null);